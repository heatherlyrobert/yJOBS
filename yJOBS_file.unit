#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP  [0a/·]  (FILE) verify central file security                                0s   secure          yjobs_file_secure                                                            ((03.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create working variable              - - - - - - - - - - - - -   char    x_tmp    [LEN_HUND]  = "/tmp";                                                                                                                                                                                           
   local      create working variable              - - - - - - - - - - - - -   char    x_dir    [LEN_HUND]  = "/tmp/lib/polymnia";                                                                                                                                                                              
   local      create working variable              - - - - - - - - - - - - -   char    x_world  [LEN_HUND]  = "world.ctrl";                                                                                                                                                                                     
   local      create working variable              - - - - - - - - - - - - -   char    x_db     [LEN_HUND]  = "polymnia.db";                                                                                                                                                                   
   local      create working variable              - - - - - - - - - - - - -   char    x_conf   [LEN_HUND]  = "eos.conf";                                                                                                                                                                      
   local      create working variable              - - - - - - - - - - - - -   char    x_file   [LEN_HUND]  = "";                                                                                                                                                                              

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yjobs__unit_quiet                                                                                                                 i_equal     0                                                                                                    

   COND  (0)  create testing files                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     prepare outputs                      - - - - - - - - - - - - -   yURG_msg_tmp (); yURG_msg_live ();  yURG_err_tmp ();  yURG_err_live ();                                                                                                                                                    
     exec     clear score                          ySCORE_clear                                                                                                                      i_equal     0                                                                                                    

   COND       create database                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     create file name                     - - - - - - - - - - - - -   snprintf (x_file, LEN_HUND, "%s/%s", x_tmp, x_db);                                                                                                                                                                                                          
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  
     exec     ... create file                      yENV_touch                  x_file                                                    , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  root        root        rw-------  ´                

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UPOLYMNIA, ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UPOLYMNIA, ACT_VAUDIT   , "central database"    , "DSECURE" , "DFIX"    , x_tmp, x_db   , "", ""  i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá pu a! ··- ····   SEá ···   LOá · ·· ···· ··   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬   HDá ···   DBá s·· ······   WOá ··· ····   ACá gn-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  root        root        rw-------  ´                

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     10                                                                                                   
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit central database existance and security...                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file  11åpolymnia.dbæ                                                                 
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       16å/tmp/polymnia.dbæ                                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- success, central database exists and security is appropriate                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   COND       verify ignoring duplicate run                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database secure                 yjobs_file_secure           IAM_UPOLYMNIA, ACT_VAUDIT   , "central database"    , "DSECURE" , "DFIX"    , x_tmp, x_db   , "", ""  i_equal     RC_ACK                                                                                               
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá pu a! ··- ····   SEá ···   LOá · ·· ···· ··   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬   HDá ···   DBá s·· ······   WOá ··· ····   ACá gn-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     10                                                                                                   

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt on database with issues                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     update file                          yENV_touch                  x_file                                                    , "member", "users" , "0644"                c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  member      users       rw-r--r--  ´                
     exec     call force environment               yjobs__unit_environ         IAM_UPOLYMNIA, ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UPOLYMNIA, ACT_VAUDIT   , "central database"    , "DSECURE" , "DFIX"    , x_tmp, x_db   , "", ""  i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá pu a! ··- ····   SEá ···   LOá · ·· ···· ··   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬   HDá ···   DBá °·· ······   WOá ··· ····   ACá gn-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  member      users       rw-r--r--  ´                

   COND       check trouble                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     9                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit central database existance and security...                                                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file  11åpolymnia.dbæ                                                                 
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       16å/tmp/polymnia.dbæ                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal                                                                                                          
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, BOLD_ERR "FAILED, central database is not proper and/or secure, the reasons are shown above" BOLD_OFF);                                                                                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     3                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, owned by åmemberæ (1000); BUT expected årootæ (0)" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     [[ u_error ]]                                                                                        
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, grouped in åusersæ (100); BUT expected årootæ (0)" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR          , 'Ö'                                                                               s_equal     [[ u_error ]]                                                                                        
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, permissions åf_normalæ, 0644, disp årw-r--r--æ; BUT expected åf_tightæ, 0600, disp årw-------æ" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR          , 'Ö'                                                                               s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR          , 'Ö'                                                                               s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify fixing the database                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  member      users       rw-r--r--  ´                
     exec     call force environment               yjobs__unit_environ         IAM_UPOLYMNIA, ACT_VFIX     , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UPOLYMNIA, ACT_VFIX     , "central database"    , "DSECURE" , "DFIX"    , x_tmp, x_db   , "", ""  i_equal     RC_POSITIVE                                                                                          
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá pu f! ··- ····   SEá ···   LOá · ·· ···· ··   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬   HDá ···   DBá sf· ······   WOá ··· ····   ACá gn-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/polymnia.db                               r  root        root        rw-------  ´                

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     11                                                                                                   
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit central database existance and security...                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file  11åpolymnia.dbæ                                                                 
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       16å/tmp/polymnia.dbæ                                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry updated successfully because of fix flag (y)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- success, central database exists and security is appropriate                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry owner, group, perms" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       create world                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     create file name                     - - - - - - - - - - - - -   snprintf (x_file, LEN_HUND, "%s/%s", x_tmp, x_world);                                                                                                                                                                                                       
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  
     exec     ... create file                      yENV_touch                  x_file                                                    , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/world.ctrl                                r  root        root        rw-------  ´                

   COND       verify world file sucess                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UPOLYMNIA, ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UPOLYMNIA, ACT_VAUDIT   , "world file"          , "WSECURE" , "WFIX"    , x_tmp, x_world, "", ""  i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá pu a! ··- ····   SEá ···   LOá · ·· ···· ··   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬   HDá ···   DBá ··· ······   WOá s·· ····   ACá gn-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/world.ctrl                                r  root        root        rw-------  ´                
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     10                                                                                                   
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit world file existance and security...                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file  10åworld.ctrlæ                                                                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       15å/tmp/world.ctrlæ                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- success, world file exists and security is appropriate                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       create conf file                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     create file name                     - - - - - - - - - - - - -   snprintf (x_file, LEN_HUND, "%s/%s", x_tmp, x_conf);                                                                                                                                                                                                        
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  
     exec     ... create file                      yENV_touch                  x_file                                                    , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/eos.conf                                  r  root        root        rw-------  ´                

   COND       verify central configuration file success                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UEOS     , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UEOS     , ACT_VAUDIT   , "shared configuration", "FFSEC"   , "FFFIX"   , x_tmp, x_conf , "", ""  i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá eu a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá e1 ··   CFá s·· ····   ¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -n-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 
     exec     ... check on file                    yENV_detail_unit            x_file                                                                                                s_equal     /tmp/eos.conf                                  r  root        root        rw-------  ´                
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     10                                                                                                   
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit shared configuration existance and security...                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file   8åeos.confæ                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       13å/tmp/eos.confæ                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- success, shared configuration exists and security is appropriate                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       attempt with missing file (in fix)                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  
     exec     call force environment               yjobs__unit_environ         IAM_UEOS     , ACT_VFIX     , ""                                                                      i_equal     0                                                                                                    
     exec     call database secure                 yjobs_file_secure           IAM_UEOS     , ACT_VFIX     , "shared configuration", "FFSEC"   , "FFFIX"   , x_tmp, x_conf , "", ""  i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá eu f! ··- ····   SEá ···   LOá · ·· ···· ··   CDá e1 ··   CFá °-· ····   ¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -n-   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     8                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit shared configuration existance and security...                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir    4å/tmpæ                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file   8åeos.confæ                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       13å/tmp/eos.confæ                                                              
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/s) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal                                                                                                          
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, BOLD_ERR "FAILED, shared configuration is not proper and/or secure, the reasons are shown above" BOLD_OFF);                                                                                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     2                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_YEL "** warning, troubles with entry non-existance" BOLD_OFF);                                                                                                                                         
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     [[ u_error ]]                                                                                        
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, regular (r) requested creation (y) requires any force (!y), but used (-)" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR          , 'Ö'                                                                               s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR          , 'Ö'                                                                               s_equal     (n/a)                                                                                                

   COND       clean-up                                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     create file name                     - - - - - - - - - - - - -   snprintf (x_file, LEN_HUND, "%s/%s", x_tmp, x_db);                                                                                                                                                                                                          
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  
     code     create file name                     - - - - - - - - - - - - -   snprintf (x_file, LEN_HUND, "%s/%s", x_tmp, x_world);                                                                                                                                                                                                          
     exec     ... remove file                      yENV_rm                     x_file                                                                                                c_equal     '-'                                                                                                  

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((04.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yjobs__unit_end                                                                                                                   i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP  [0a/·]  (FILE) verify defenses on review                                   0s   defense         yjobs_file_review                                                            ((03.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create working variable              - - - - - - - - - - - - -   char    x_cdir   [LEN_HUND]  = "/tmp/spool/khronos/";                                                                                                                                                                            
   local      create working variable              - - - - - - - - - - - - -   char    x_file   [LEN_HUND]  = "root.daily";                                                                                                                                                                                     
   local      create working variable              - - - - - - - - - - - - -   char    x_full   [LEN_HUND]  = "";                                                                                                                                                                                               

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yjobs__unit_quiet                                                                                                                 i_equal     0                                                                                                    
     exec     create full                          yENV_name_full              x_cdir    , x_file    , NULL      , x_full                                                            i_equal     RC_POSITIVE                                                                                          

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       check defense for bad reason code                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , 'j' ,  3, x_cdir   , x_file   , "(USER)." , ""       , u_call   , 'y'   i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá °·· ····   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 

   COND  (1)  verify messages                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     2                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , '['                                                                   s_equal                                                                                                          
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, BOLD_ERR "FAILED, file review handled bad file/data, the reasons are shown above" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   COND       verify errors                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, reason code (106/j) is illegal å=spaæ" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       check defense for null directory                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , '=' ,  3, NULL     , x_file   , "(USER)." , ""       , u_call   , 'y'   i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··· ···°   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify errors                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, configuration directory name is NULL/empty" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       check defense for null file                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , '=' ,  3, x_cdir   , NULL     , ""       , ""       , u_call    , 'y'   i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··· ···°   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify errors                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, configuration file name is NULL/empty" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       check defense for null callback                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , '=' ,  3, x_cdir   , x_file   , ""       , ""       , NULL      , 'y'   i_lesser    0                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··· ···°   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá f °æ 

   DITTO (1)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify errors                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     1                                                                                                    
     code     create error message                 - - - - - - - - - - - - -   strcpy (u_error, "  " BOLD_ERR "** FATAL, host callback function is NULL" BOLD_OFF);                                                                                                
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     [[ u_error ]]                                                                                        
     exec     ... review line                      yENV_peek                   YURG_ERR                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                

   REUSE -Z-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((04.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yjobs__unit_end                                                                                                                   i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP  [0a/·]  (FILE) verify spool files                                          0s   spool           yjobs_file_review                                                            ((03.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   local      create working variable              - - - - - - - - - - - - -   char    x_cdir   [LEN_HUND]  = "/tmp/spool/khronos/";                                                                                                                                                                            
   local      create working variable              - - - - - - - - - - - - -   char    x_file   [LEN_HUND]  = "root.daily";                                                                                                                                                                                     
   local      create working variable              - - - - - - - - - - - - -   char    x_full   [LEN_HUND]  = "";                                                                                                                                                                                               

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yjobs__unit_quiet                                                                                                                 i_equal     0                                                                                                    
     exec     create full                          yENV_name_full              x_cdir    , x_file    , NULL      , x_full                                                            i_equal     RC_POSITIVE                                                                                          

   COND       setup directories                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((09.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove directories                   yJOBS_rmdirs                                                                                                                      i_equal     0                                                                                                    
     exec     setup working directories            yJOBS_mkdirs                                                                                                                      i_equal     0                                                                                                    

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND  (0)  setup files                                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((05.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  
     exec     ... create file                      yENV_touch                  x_full                                                    , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  
     exec     ... check on file                    yENV_detail_unit            x_full                                                                                                s_equal     /tmp/spool/khronos/root.daily                  r  root        root        rw-------  ´               

   COND       verify listing file                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_LIST     , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_LIST     , '=' ,  3, x_cdir   , x_file   , "(USER)." , ""       , u_call   , 'y'   i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku =- ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··· ···=   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 

   COND       verify results                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG                      , '['                                                                   s_equal     /tmp/spool/khronos/root.daily                                                                            
     exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify security check                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , 's' ,  3, x_cdir   , x_file   , "(USER)." , ""       , u_call   , 'y'   i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá s·· ····   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     11                                                                                                   
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit spool file (3) existance and security...                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested dir   19å/tmp/spool/khronos/æ                                                         
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- requested file  10åroot.dailyæ                                                                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- full name       29å/tmp/spool/khronos/root.dailyæ                                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- name (b/c) is fully qualified, not hidden/temp, and uses only legal characters                  
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- good, running as årootæ, uid (0) so can handle file prefixed as årootæ                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- success, spool file (3) exists and security is appropriate                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify pull action                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , 'p' ,  3, x_cdir   , x_file   , "(USER)." , ""       , u_call   , 'y'   i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··· Ö···   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     3                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     read spool file (3) into environment (PULL)...                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- skipping, host-based action (must string-test downstream)                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   REUSE -A-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   DITTO (0)  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify audit action                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call force environment               yjobs__unit_environ         IAM_UKHRONOS , ACT_VAUDIT   , ""                                                                      i_equal     0                                                                                                    
     exec     call single file review              yjobs_file_review           IAM_UKHRONOS , ACT_VAUDIT   , 'a' ,  3, x_cdir   , x_file   , "(USER)." , ""       , u_call   , 'y'   i_equal     1                                                                                                    
     get      ... check score                      ySCORE_score                                                                                                                      w_equal     åHEá ku a! ··- ····   SEá ···   LOá · ·· ···· ··   CDá s* ··   CFá ··a ····   HDá ···   ¬¬¬¬¬¬¬¬¬¬¬¬¬¬   ¬¬¬¬¬¬¬¬¬¬¬¬   ACá -nd   ¬¬¬¬¬¬¬¬¬¬¬¬¬   JDá ·  æ 

   COND       verify expected output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     6                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , '['                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     read spool file (3) into environment (PULL)...                                    
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- skipping, host-based action (must string-test downstream)                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal                                                                                                          
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     audit-only, purge spool file (3) after reading (PURGE)...                                               
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     ¬¬-- skipping, host-based action (must string-test downstream)                                            
     exec     ... review line                      yENV_peek                   YURG_MSG          , 'Ö'                                                                               s_equal     (n/a)                                                                                                
     exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
     exec     ... review line                      yENV_peek                   YURG_ERR          , '['                                                                               s_equal     (n/a)                                                                                                

   COND       clean up file                                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yENV_rm                     x_full                                                                                                c_equal     '-'                                                                                                  

   REUSE -Z-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((04.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yjobs__unit_end                                                                                                                   i_equal     0                                                                                                    



# end-of-file.  done, finito, completare, whimper [Ï´···
