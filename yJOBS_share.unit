#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP  [0a/·]  (SHARE) verify handling single-conf files                          0s   single          yjobs__share_single                                                          ((04.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

#> COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((04.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     initialize the system                yjobs__unit_quiet                                                                                                                 i_equal     0                                                                                                    
#>   local    create working variable              - - - - - - - - - - - - -   int     i        =  1;                                                                                                                                                                                                     
#>   exec     remove directories                   yJOBS_rmdirs                                                                                                                      i_equal     0                                                                                                    
#>   exec     setup working directories            yJOBS_mkdirs                                                                                                                      i_equal     0                                                                                                    
#>   code     ... update mode                      - - - - - - - - - - - - -   myJOBS.m_mode    = ACT_LIST;                                                                                                                                                                                               

#> COND  (0)  remove testing files                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     remove file                          yENV_rm                     "/tmp/etc/eos.conf"                                                                                   c_equal     '-'                                                                                                  

#> COND  (1)  create testing files                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     create a sample file                 yENV_touch                  "/tmp/etc/eos.conf"                                       , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  

#> COND       verify simple success                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     call clear mode                      yjobs_args__clearmode       NULL   , NULL    , NULL                                                                               i_equal     0                                                                                                    
#>   exec     reset msg/err                        yURG_all_tmp                                                                                                                      i_equal     0                                                                                                    
#>   get      ... allow errors                     yURG_all_live                                                                                                                     i_equal     0                                                                                                    
#>   exec     call runas                           yjobs_runas                 "eos_unit"           , NULL                                                                           i_equal     0                                                                                                    
#>   exec     call arg finder                      yJOBS_argument              &i     , "--list"             , NULL                                   , NULL   , NULL    , NULL      i_equal     1                                                                                                    
#>   exec     call final                           yJOBS_final                 0                                                                                                     i_equal     0                                                                                                    
#>   get      ... run modes                        yjobs_base__unit            "mode"                                                                                                s_equal     BASE mode        : iam (E) eos-¬¬¬¬¬¬¬¬¬¬¬¬¬¬, run (=) list (silent)     , åeos.confæ                        
#>   exec     call single                          yjobs__share_single         IAM_UEOS     , ACT_LIST     , "/tmp/etc/"      , "eos.conf"         , "root"  , 0   , yjobs_callback  i_equal     1                                                                                                    

#> COND       verify results                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     1                                                                                                    
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , '['                                                                   s_equal     /tmp/etc/eos.conf                                                                                        
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
#>   exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
#>   exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     (n/a)                                                                                                

#> COND  (0)  remove testing files                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     remove file                          yENV_rm                     "/tmp/etc/eos.conf"                                                                                   c_equal     '-'                                                                                                  

#> COND       attempt with missing file                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     call clear mode                      yjobs_args__clearmode       NULL   , NULL    , NULL                                                                               i_equal     0                                                                                                    
#>   exec     reset msg/err                        yURG_all_tmp                                                                                                                      i_equal     0                                                                                                    
#>   get      ... allow errors                     yURG_all_live                                                                                                                     i_equal     0                                                                                                    
#>   exec     call runas                           yjobs_runas                 "eos_unit"           , NULL                                                                           i_equal     0                                                                                                    
#>   exec     call arg finder                      yJOBS_argument              &i     , "--list"             , NULL                                   , NULL   , NULL    , NULL      i_equal     1                                                                                                    
#>   exec     call final                           yJOBS_final                 0                                                                                                     i_equal     0                                                                                                    
#>   get      ... run modes                        yjobs_base__unit            "mode"                                                                                                s_equal     BASE mode        : iam (E) eos-¬¬¬¬¬¬¬¬¬¬¬¬¬¬, run (=) list (silent)     , åeos.confæ                        
#>   exec     call single                          yjobs__share_single         IAM_UEOS     , ACT_LIST     , "/tmp/etc/"      , "eos.conf"         , "root"  , 0   , yjobs_callback  i_lesser    0                                                                                                    

#> COND       verify results                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     0                                                                                                    
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , '['                                                                   s_equal     (n/a)                                                                                                
#>   exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
#>   exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     (n/a)                                                                                                

#> COND  (1)  create testing files                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     create a sample file                 yENV_touch                  "/tmp/etc/eos.conf"                                       , "root"  , "root"  , "0600"                c_equal     'r'                                                                                                  

#> COND       verify simple success                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     call clear mode                      yjobs_args__clearmode       NULL   , NULL    , NULL                                                                               i_equal     0                                                                                                    
#>   exec     reset msg/err                        yURG_all_tmp                                                                                                                      i_equal     0                                                                                                    
#>   get      ... allow errors                     yURG_all_live                                                                                                                     i_equal     0                                                                                                    
#>   exec     call runas                           yjobs_runas                 "eos_unit"           , NULL                                                                           i_equal     0                                                                                                    
#>   exec     call arg finder                      yJOBS_argument              &i     , "--vaudit"           , NULL                                   , NULL   , NULL    , NULL      i_equal     1                                                                                                    
#>   exec     call final                           yJOBS_final                 0                                                                                                     i_equal     0                                                                                                    
#>   get      ... run modes                        yjobs_base__unit            "mode"                                                                                                s_equal     BASE mode        : iam (E) eos-¬¬¬¬¬¬¬¬¬¬¬¬¬¬, run (A) audit (verbose)   , åeos.confæ                        
#>   exec     call single                          yjobs__share_single         IAM_UEOS     , ACT_AUDIT    , "/etc/"          , "eos.conf"         , "root"  , 0   , yjobs_callback  i_equal     RC_POSITIVE                                                                                          

#> COND       verify results                                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((06.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
#>   exec     verify messages output               yENV_lines                  YURG_MSG                                                                                              i_equal     15                                                                                                   
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , '['                                                                   s_equal                                                                                                          
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     central file security check...                                                                                                     
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- requested dir    5å/etc/æ                                                                                                                              
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- requested file   8åeos.confæ                                                                                                                      
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- full name       13å/etc/eos.confæ                                                                                                                                  
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- name (b/c) is fully qualified, not hidden/temp, and uses only legal characters                                                                                             
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- prefix åeos.æ and suffix å.confæ match given standard                                                 
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- good, running as årootæ, uid (0) and file is located in or below å/etc/æ             
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- regular (r) entry existance confirmed, AND not a symlink/hardlink                               
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- ownership confirmed, owned by årootæ (0) and in group årootæ (0)                                
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- permissions confirmed, åf_tightæ, 0600, disp årw-------æ                                        
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- success, central file secure/acceptable                                                                  
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal                                                                                                                                               
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     host-based verification of a source/configuration file (pull)...   
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     ¬¬-- skipping, host-based action (must string-test downstream)                                                                            
#>   exec     ... review line                      yENV_peek                   YURG_MSG                      , 'Ö'                                                                   s_equal     (n/a)                                                                                                
#>   exec     verify error output                  yENV_lines                  YURG_ERR                                                                                              i_equal     0                                                                                                    
#>   exec     ... review line                      yENV_peek                   YURG_ERR                      , '['                                                                   s_equal     (n/a)                                                                                                

#> REUSE -Z-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((18.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((13.011))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yjobs__unit_end                                                                                                                   i_equal     0                                                                                                    



# end-of-file.  done, finito, completare, whimper [Ï´···
